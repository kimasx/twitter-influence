source('C:/Users/sunkim/Development/twitter-influence/inf_score.r')
metrics <- rename(metrics, mentions = count, retweets = sum) %>%
metrics <- transform(metrics, followers_count = as.numeric(followers_count), tweets_count = as.numeric(tweets_coun
metrics <- rename(metrics, mentions = count, retweets = sum) %>%
metrics <- transform(metrics, followers_count = as.numeric(followers_count), tweets_count = as.numeric(tweets_count), mentions = as.numeric(mentions))
metrics <- rename(metrics, mentions = count, retweets = sum) %>%
metrics <- transform(metrics, followers_count = as.numeric(followers_count), mentions = as.numeric(mentions))
metrics <- rename(metrics, mentions = count, retweets = sum)
metrics <- transform(metrics, followers_count = as.numeric(followers_count), mentions = as.numeric(mentions))
metrics$inf_score <- apply(metrics, 1, function(r) calculate_inf_score(
as.numeric(r['followers_count']),
as.numeric(r['retweets']),
as.numeric(r['tweets_count']),
as.numeric(r['mentions'])))
metrics$norm_score <- (metrics$inf_score - min(metrics$inf_score) ) / (max(metrics$inf_score) - min(metrics$inf_score))
g <- ggplot(metrics, aes(reorder(handle,norm_score), norm_score)) + geom_bar(stat='identity')+coord_flip()
g + labs(y='Influence Score (0-1)', x='Top 33 Twitter Users by Num. of Followers')
metrics$inf_score <- mapply(calculate_inf_score, metrics$followers_count, metrics$retweets, metrics$tweets_count, metrics$mentions)
metrics$inf_score <- mapply(calculate_inf_score, metrics$followers_count, metrics$retweets, metrics$tweets_count, metrics$mentions)
metrics$norm_score <- (metrics$inf_score - min(metrics$inf_score) ) / (max(metrics$inf_score) - min(metrics$inf_score))
g <- ggplot(metrics, aes(reorder(handle,norm_score), norm_score)) + geom_bar(stat='identity')+coord_flip()
g + labs(y='Influence Score (0-1)', x='Top 33 Twitter Users by Num. of Followers')
source('C:/Users/sunkim/Development/twitter-influence/inf_score.r')
source('C:/Users/sunkim/Development/twitter-influence/inf_score.r')
metrics <- cbind(metrics,inf_score) %>% rename(metrics, mentions = count, retweets = sum)
metrics[c('tweets_count', 'followers_count', 'retweets')] <- lapply(metrics, function(x) as.numeric(x))
metrics <- lapply(metrics[c('tweets_count', 'followers_count', 'retweets')], function(x) as.numeric(x))
metrics[] <- lapply(metrics[c('tweets_count', 'followers_count', 'retweets')], function(x) as.numeric(x))
source('C:/Users/sunkim/Development/twitter-influence/inf_score.r')
g
View(tweets_count)
View(user_info)
View(user_info)
View(metrics)
View(metrics)
View(metrics)
View(metrics)
View(metrics)
library(xlsx)
install.packages('xlsx')
library(xlsx)
library(xlsx)
setwd("C:/Users/sunkim/Development/twitter-influence")
usersGainedData <- read.xlsx('../../OneDrive - Harvard Business School/twitter_user_changes')
usersGainedData <- read.xlsx('../../OneDrive - Harvard Business School/twitter_user_changes.xlsx',sheetIndex = 1, header = TRUE)
usersGainedData
usersGainedData <- read.xlsx('../../OneDrive - Harvard Business School/twitter_user_changes.xlsx',sheetIndex = 1, header = TRUE)
View(usersGainedData)
usersGainedData$percent_change
gained <- ggplot(usersGainedData, aes(reorder(handle,percent_change), percent_change)) + geom_bar(stat='identity')+coord_flip()
gained + labs(y='users', x='percent change')
gained <- ggplot(usersGainedData, aes(handle), percent_change)) + geom_bar(stat='identity')+coord_flip()
gained <- ggplot(usersGainedData, aes(handle, percent_change)) + geom_bar(stat='identity')+coord_flip()
gained + labs(y='users', x='percent change')
gained <- ggplot(usersGainedData, aes(reorder(handle,metrics$norm_score), percent_change)) + geom_bar(stat='identity')+coord_flip()
gained + labs(y='users', x='percent change')
usersGainedData <- read.xlsx('../../OneDrive - Harvard Business School/twitter_user_changes.xlsx',sheetIndex = 1, header = TRUE)
gained <- ggplot(usersGainedData, aes(reorder(handle,metrics$norm_score), percent_change)) + geom_bar(stat='identity')+coord_flip()
gained + labs(x='users', y='percent change')
correlationDf <- data.frame(metrics$handle, metrics$norm_score, usersGainedData$percent_change)
correlationDf
View(correlationDf)
View(correlationDf)
View(metrics)
cor.test(x=correlationDf$metrics.norm_score, y=correlationDf$usersGainedData.percent_change, method = 'spearman')
correlationDf
colnames(correlationDf) <- newColNames
newColNames <- c('inf_score', 'percent_change_followers')
colnames(correlationDf) <- newColNames
correlationDf
newColNames <- c('user','inf_score', 'percent_change_followers')
correlationDf
ewColNames <- c('user','inf_score', 'percent_change_followers')
colnames(correlationDf) <- newColNames
correlationDf
cor.test(x=correlationDf$inf_score, y=correlationDf$percent_change_followers, method = 'spearman')
linCorr <- ggplot(correlationDf, aes(x=inf_score, y=percent_change_followers)) + geom_point(color='#2980B9', size = 4)
linCorr
linCorr + scale_x_continuous(name='Influence Score', limits=c(0,25))
linCorr <- ggplot(correlationDf, aes(x=inf_score, y=percent_change_followers)) + geom_point(color='#2980B9', size = 4)
linCorr
linCorr + scale_x_continuous(name='Influence Score', limits=c(0,0.25))
linCorr + scale_x_continuous(name='Influence Score') + scale_y_continuous(name='Percent Change in Number of Followers')
linCorr <- ggplot(correlationDf, aes(x=inf_score, y=percent_change_followers)) + geom_point(color='#2980B9', size = 2)
linCorr <- ggplot(correlationDf, aes(x=inf_score, y=percent_change_followers)) + geom_point(color='#2980B9', size = 2)
linCorr + scale_x_continuous(name='Influence Score') + scale_y_continuous(name='Percent Change in Number of Followers')
linCorr <- ggplot(correlationDf, aes(x=inf_score, y=percent_change_followers)) + geom_point(color='#2980B9', size = 2)
linCorr + scale_x_continuous(name='Influence Score')
+ scale_y_continuous(name='Percent Change in Number of Followers')
+ stat_smooth(method="lm",formula=y~log(x),fill="red")
linCorr <- ggplot(correlationDf, aes(x=inf_score, y=percent_change_followers)) + geom_point(color='#2980B9', size = 2)
linCorr + scale_x_continuous(name='Influence Score') + scale_y_continuous(name='Percent Change in Number of Followers') + stat_smooth(method="lm",formula=y~log(x),fill="red")
linCorr + scale_x_continuous(name='Influence Score') + scale_y_continuous(name='Percent Change in Number of Followers') + stat_smooth(method="lm",formula=percent_change_followers~log(inf_score),fill="red")
linCorr + scale_x_continuous(name='Influence Score') + scale_y_continuous(name='Percent Change in Number of Followers') + stat_smooth(method="lm",formula=correlationDf$percent_change_followers~log(correlationDf$inf_score),fill="red")
linCorr + scale_x_continuous(name='Influence Score') + scale_y_continuous(name='Percent Change in Number of Followers') + stat_smooth(method="lm",formula=(correlationDf$percent_change_followers)~log(correlationDf$inf_score),fill="red")
correlationDf <- data.frame(metrics$handle, metrics$norm_score, usersGainedData$percent_change)
newColNames <- c('user','inf_score', 'percent_change_followers')
colnames(correlationDf) <- newColNames
cor.test(x=correlationDf$inf_score, y=correlationDf$percent_change_followers, method = 'spearman')
linCorr <- ggplot(correlationDf, aes(x=inf_score, y=percent_change_followers)) + geom_point(color='#2980B9', size = 2)
linCorr + scale_x_continuous(name='Influence Score') + scale_y_continuous(name='Percent Change in Number of Followers') + stat_smooth(method="lm",formula=(correlationDf$percent_change_followers)~log(correlationDf$inf_score),fill="red")
linCorr + scale_x_continuous(name='Influence Score') + scale_y_continuous(name='Percent Change in Number of Followers') + stat_smooth(method="lm",formula=y~log(x),fill="red")
linCorr + scale_x_continuous(name='Influence Score') + scale_y_continuous(name='Percent Change in Number of Followers') + geom_smooth(method="lm",formula=y~log(x),fill="red")
linCorr + scale_x_continuous(name='Influence Score') + scale_y_continuous(name='Percent Change in Number of Followers') + geom_smooth(method="lm",fill="red")
linCorr + scale_x_continuous(name='Influence Score') + scale_y_continuous(name='Percent Change in Number of Followers') + geom_smooth(method="lm", formula=y~log(x), fill="red")
linCorr + scale_x_continuous(name='Influence Score') + scale_y_continuous(name='Percent Change in Number of Followers') + geom_smooth(method="lm", formula=x~log(y), fill="red")
linCorr + scale_x_continuous(name='Influence Score') + scale_y_continuous(name='Percent Change in Number of Followers') + geom_smooth(method="lm", formula=x~log(y), fill="red")
linCorr + scale_x_continuous(name='Influence Score') + scale_y_continuous(name='Percent Change in Number of Followers') + stat_smooth(method="lm", formula=x~log(y), fill="red")
linCorr + scale_x_continuous(name='Influence Score') + scale_y_continuous(name='Percent Change in Number of Followers') + stat_smooth(method="lm", formula=y~log(x), fill="red")
linCorr + scale_x_continuous(name='Influence Score') + scale_y_continuous(name='Percent Change in Number of Followers') + stat_smooth(method="lm", formula=y ~ log(x), fill="red")
linCorr + scale_x_continuous(name='Influence Score', limit=c(0,0.4)) + scale_y_continuous(name='Percent Change in Number of Followers')
linCorr <- ggplot(correlationDf, aes(x=inf_score, y=percent_change_followers)) + geom_point(color='#2980B9', size = 2)
linCorr + scale_x_continuous(name='Influence Score', limit=c(0,0.4)) + scale_y_continuous(name='Percent Change in Number of Followers')
linCorr + scale_x_continuous(name='Influence Score') + scale_y_continuous(name='Percent Change in Number of Followers')
linCorr + scale_x_continuous(name='Influence Score', limits = c(0,0.4)) + scale_y_continuous(name='Percent Change in Number of Followers')
linCorr + scale_x_continuous(name='Influence Score', limits = c(0,0.37)) + scale_y_continuous(name='Percent Change in Number of Followers')
linCorr + scale_x_continuous(name='Influence Score', limits = c(0,0.35)) + scale_y_continuous(name='Percent Change in Number of Followers')
linCorr <- ggplot(correlationDf, aes(x=inf_score, y=percent_change_followers)) + geom_point(color='#2980B9', size = 2) + stat_smooth(method = 'lm', formula = y ~ log(x))
linCorr + scale_x_continuous(name='Influence Score') + scale_y_continuous(name='Percent Change in Number of Followers')
linCorr <- ggplot(correlationDf, aes(x=percent_change_followers, y=inf_score)) + geom_point(color='#2980B9', size = 2)
linCorr + scale_x_continuous(name='Influence Score') + scale_y_continuous(name='Percent Change in Number of Followers')
linCorr <- ggplot(correlationDf, aes(x=percent_change_followers, y=inf_score)) + geom_point(color='#2980B9', size = 2)stat_smooth(method = 'lm', formula = y ~ log(x))
linCorr + scale_x_continuous(name='Influence Score') + scale_y_continuous(name='Percent Change in Number of Followers')
linCorr <- ggplot(correlationDf, aes(x=percent_change_followers, y=inf_score)) + geom_point(color='#2980B9', size = 2) + stat_smooth(method = 'lm', formula = y ~ log(x))
linCorr + scale_x_continuous(name='Influence Score') + scale_y_continuous(name='Percent Change in Number of Followers')
linCorr <- ggplot(correlationDf, aes(x=inf_score, y=percent_change_followers)) + geom_point(color='#2980B9', size = 2)
linCorr + scale_x_continuous(name='Influence Score') + scale_y_continuous(name='Percent Change in Number of Followers')
logEstimate <- lm(correlationDf$percent_change_followers ~ log(correlationDf$inf_score))
lines(correlationDf$inf_score, predict(logEstimate), col='red')
points(correlationDf$inf_score, correlationDf$percent_change_followers)
logEstimate <- lm(correlationDf$percent_change_followers ~ log(correlationDf$inf_score))
plot(correlationDf$inf_score, correlationDf$percent_change_followers)
lines(correlationDf$inf_score, predict(logEstimate), col='red')
points(correlationDf$inf_score, correlationDf$percent_change_followers)
logEstimate = lm(correlationDf$percent_change_followers ~ log(correlationDf$inf_score))
plot(correlationDf$inf_score, correlationDf$percent_change_followers)
lines(correlationDf$inf_score, predict(logEstimate), col='red')
points(correlationDf$inf_score, correlationDf$percent_change_followers)
logEstimate <- lm(correlationDf$percent_change_followers ~ log(correlationDf$inf_score))
correlationDf <- data.frame(metrics$handle, metrics$norm_score, usersGainedData$percent_change)
newColNames <- c('user','inf_score', 'percent_change_followers')
colnames(correlationDf) <- newColNames
cor.test(x=correlationDf$inf_score, y=correlationDf$percent_change_followers, method = 'spearman')
linCorr <- ggplot(correlationDf, aes(x=inf_score, y=percent_change_followers)) + geom_point(color='#2980B9', size = 2)
linCorr + scale_x_continuous(name='Influence Score') + scale_y_continuous(name='Percent Change in Number of Followers')
linCorr + scale_x_continuous(name='Influence Score', limits = c(0,0.25)) + scale_y_continuous(name='Percent Change in Number of Followers')
linCorr + scale_x_continuous(name='Influence Score', limits = c(0,0.35)) + scale_y_continuous(name='Percent Change in Number of Followers')
linCorr + scale_x_continuous(name='Influence Score') + scale_y_continuous(name='Percent Change in Number of Followers')
correlationDf <- data.frame(metrics$handle, metrics$norm_score, usersGainedData$percent_change)
newColNames <- c('user','inf_score', 'percent_change_followers')
colnames(correlationDf) <- newColNames
cor.test(x=log(correlationDf$inf_score), y=log(correlationDf$percent_change_followers), method = 'spearman')
linCorr <- ggplot(correlationDf, aes(x=inf_score, y=percent_change_followers)) + geom_point(color='#2980B9', size = 2)
linCorr + scale_x_continuous(name='Influence Score') + scale_y_continuous(name='Percent Change in Number of Followers')
cor.test(x=log(correlationDf$inf_score), y=log(correlationDf$percent_change_followers), method = 'spearman')
cor.test(x=log(correlationDf$inf_score), y=log(correlationDf$percent_change_followers+ 1 - min(correlationDf$percent_change_followers)), method = 'spearman')
cor.test(x=log(correlationDf$inf_score), y=log(correlationDf$percent_change_followers+ 1 - min(correlationDf$percent_change_followers)), method = 'spearman')
linCorr <- ggplot(correlationDf, aes(x=inf_score, y=percent_change_followers)) + geom_point(color='#2980B9', size = 2)
linCorr + scale_x_continuous(name='Influence Score') + scale_y_continuous(name='Percent Change in Number of Followers')
cor.test(x=log(correlationDf$inf_score), y=log(correlationDf$percent_change_followers+ 1 - min(correlationDf$percent_change_followers)), method = 'spearman')
linCorr <- ggplot(correlationDf, aes(x=log(inf_score), y=log(correlationDf$percent_change_followers+ 1 - min(correlationDf$percent_change_followers)))) + geom_point(color='#2980B9', size = 2)
linCorr + scale_x_continuous(name='Influence Score') + scale_y_continuous(name='Percent Change in Number of Followers')
linCorr <- ggplot(correlationDf, aes(x=log(inf_score), y=log(correlationDf$percent_change_followers+ 0.1 - min(correlationDf$percent_change_followers)))) + geom_point(color='#2980B9', size = 2)
linCorr + scale_x_continuous(name='Influence Score') + scale_y_continuous(name='Percent Change in Number of Followers')
linCorr <- ggplot(correlationDf, aes(x=inf_score, y=percent_change_followers)) + geom_point(color='#2980B9', size = 2)
linCorr + scale_x_continuous(name='Influence Score') + scale_y_continuous(name='Percent Change in Number of Followers')
cor.test(x=log(correlationDf$inf_score), y=log(correlationDf$percent_change_followers+ 1 - min(correlationDf$percent_change_followers)), method = 'spearman')
cor.test(x=correlationDf$inf_score, y=correlationDf$percent_change_followers, method = 'spearman')
cor.test(x=log(correlationDf$inf_score), y=correlationDf$percent_change_followers, method = 'spearman')
linCorr <- ggplot(correlationDf, aes(x=log(inf_score), y=percent_change_followers)) + geom_point(color='#2980B9', size = 2)
linCorr + scale_x_continuous(name='Influence Score') + scale_y_continuous(name='Percent Change in Number of Followers')
cor.test(x=log(correlationDf$inf_score), y=correlationDf$percent_change_followers, method = 'spearman')
log(correlationDf$inf_score)
correlationDf$inf_score
correlationDf$log <- log(correlationDf$inf_score)
cor.test(x=correlationDf$log, y=correlationDf$percent_change_followers, method = 'spearman')
cor.test(x=log(correlationDf$inf_score), y=correlationDf$percent_change_followers, method = 'spearman')
cor.test(x=correlationDf$inf_score, y=correlationDf$percent_change_followers, method = 'spearman')
linCorr <- ggplot(correlationDf, aes(x=inf_score, y=percent_change_followers)) + geom_point(color='#2980B9', size = 2)
linCorr + scale_x_continuous(name='Influence Score') + scale_y_continuous(name='Percent Change in Number of Followers')
